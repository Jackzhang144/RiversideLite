# 清水河畔助手 Lite

 Chrome 扩展，用于在清水河畔论坛收到提醒与站内信时实时显示徽标与通知，并提供便捷跳转。无打包流程，直接加载源码即可。

## 功能概览
- 徽标与桌面通知：后台定时轮询，显示未读提醒与站内信数量，点击通知或弹窗项直接打开对应帖子/私信。
- 弹窗摘要：`popup.html`/`popup.js` 展示新提醒与私信摘要，支持“标记已读”。
- MeoW 推送：在鸿蒙 5.0+ 设备上通过 MeoW App 接收论坛提醒，可选择是否附带跳转链接（不带链接/消息列表/精准帖子），支持异常状态推送和一键测试。
- 版本切换：在选项页选择“新版/旧版”界面，决定跳转链接与主页入口。
- 多账号切换：选项页本地加密保存多组账号，可一键切换；弹窗也可快速切换账号并刷新已打开的标签页。
- 权限：仅请求 `bbs.uestc.edu.cn`、`api.chuckfang.com` 域名以及 cookies、storage、notifications、alarms、scripting 等运行所需权限。

## 安装与使用
1. 打开 `chrome://extensions`，启用“开发者模式”。
2. 点击“加载已解压的扩展程序”，选择仓库根目录。
3. 修改代码后，在扩展页点击“重新加载”；弹窗调试：打开弹窗后右键→“检查”；后台日志：在扩展页打开“service worker”开发者工具。
4. 进入选项页（扩展卡片中的“详情”→“扩展选项”）切换站点版本或关闭通知。

## 设置项
- 系统通知：控制是否弹出桌面通知，关闭后仍会更新徽标。
- 版本选择：切换新版/旧版 BBS 链接，用于通知点击后的跳转。
- MeoW 推送：开启后填写在 MeoW App 中配置的昵称，可选择推送链接模式，点击“发送测试”校验推送可达。
- 账号切换：本地加密保存多组账号密码，可选择账号一键切换（切换后刷新已打开的河畔标签页）。

## 目录结构
- `manifest.json`：扩展声明、权限与入口文件。
- `background.js`：service worker，负责定时检查、调用消息摘要 API、更新徽标/通知。
- `popup.html` / `popup.js`：弹窗 UI 与交互。
- `options.html` / `options.js`：选项页设置（通知开关、版本选择、MeoW 推送）。
- `River.png`：扩展图标。

## 开发提示
- 代码风格：JavaScript 2 空格缩进、分号、`const/let`，倾向箭头函数与早返回；保持用户可见文案为简体中文。
- 快速语法检查：`node --check background.js`（或其他 JS 文件）后再重新加载扩展。
- 测试要点：确认已登录后徽标数字正确更新；弹窗加载失败时提示；“标记已读”后徽标清零；新旧版本跳转和通知点击的目标页面正确；开启 MeoW 后测试推送可达，未填写昵称或未登录时提示合理。
